{"ast":null,"code":"import _classCallCheck from \"/Users/IDogueto/Desktop/Repositories/emdashboarddeployed/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/IDogueto/Desktop/Repositories/emdashboarddeployed/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/IDogueto/Desktop/Repositories/emdashboarddeployed/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/IDogueto/Desktop/Repositories/emdashboarddeployed/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/IDogueto/Desktop/Repositories/emdashboarddeployed/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/IDogueto/Desktop/Repositories/emdashboarddeployed/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/IDogueto/Desktop/Repositories/emdashboarddeployed/src/dashboard/Step/addStep.js\";\nimport React, { Component } from 'react';\nimport LocationPicker from 'react-location-picker';\nimport { postStepCreationAPICALL, postStepLocationUpdateAPICALL } from '../../utils/requests';\nimport GLOBAL from \"../../utils/global\";\nimport Form from \"react-jsonschema-form\";\nimport { withRouter } from 'react-router-dom';\nimport Popup from 'reactjs-popup';\nimport { MAP_MARKERS_NAMES } from \"../../utils/mapMarkers\";\nimport { MAP_MARKERS } from \"../../utils/mapMarkers\";\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\n/* Default position */\n\nvar defaultPosition = {\n  lat: 33.538379,\n  lng: -5.105569\n};\nvar uiSchema = {\n  eventTitle: {\n    \"ui:readonly\": true\n  },\n  eventHashedID: {\n    \"ui:readonly\": true\n  }\n};\nvar schema = {\n  \"title\": \"Add Step\",\n  \"description\": \"Create a new step\",\n  \"type\": \"object\",\n  \"required\": [\"stepTitle\", \"stepDescription\"],\n  \"properties\": {\n    \"eventHashedID\": {\n      \"type\": \"string\",\n      \"title\": \"Event ID\"\n    },\n    \"eventTitle\": {\n      \"type\": \"string\",\n      \"title\": \"Event Title\"\n    },\n    \"stepTitle\": {\n      \"type\": \"string\",\n      \"title\": \"Step Title\"\n    },\n    \"stepDescription\": {\n      \"type\": \"string\",\n      \"title\": \"Step Description\"\n    }\n  }\n};\n\nvar AddStep =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AddStep, _Component);\n\n  function AddStep(props) {\n    var _this;\n\n    _classCallCheck(this, AddStep);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AddStep).call(this, props));\n\n    _this.onSubmitStepCreation = function (_ref, e) {\n      var _this2 = this;\n\n      var formData = _ref.formData;\n      return postStepCreationAPICALL(formData.eventHashedID, formData.stepTitle, formData.stepDescription).then(function (IDs) {\n        console.log(\"HEE:\" + IDs.eventID);\n        console.log(\"HAA:\" + IDs.stepID);\n\n        _this2.setState({\n          eventID: IDs.eventID\n        });\n\n        _this2.setState({\n          stepID: IDs.stepID\n        });\n\n        if (_this2.state.stepID.length === 24) {\n          if (window.confirm('Would you like to bind this step to a location?')) {\n            _this2.refs.popupMapBtn.click();\n          } else {\n            alert(\"Step Created Successfully\");\n\n            _this2.forceUpdate();\n          }\n        }\n      });\n    };\n\n    _this.state = {\n      position: {\n        lat: 0,\n        lng: 0\n      },\n      stepID: \"\",\n      eventID: \"\",\n      commonLocation: -1\n    };\n    if (GLOBAL.HASHEDIDEVENTCREATED !== \"\") schema.properties.eventHashedID.default = GLOBAL.HASHEDIDEVENTCREATED;\n    if (GLOBAL.EVENTTITLE !== \"\") schema.properties.eventTitle.default = GLOBAL.EVENTTITLE; // Bind\n\n    _this.handleLocationChange = _this.handleLocationChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.updateLocationOfStep = _this.updateLocationOfStep.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onSubmitStepCreation = _this.onSubmitStepCreation.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(AddStep, [{\n    key: \"handleLocationChange\",\n    value: function handleLocationChange(_ref2) {\n      var position = _ref2.position,\n          address = _ref2.address;\n      // Set new location\n      this.setState({\n        position: position\n      });\n    }\n  }, {\n    key: \"updateLocationOfStep\",\n    value: function updateLocationOfStep() {\n      var _this3 = this;\n\n      if (this.state.commonLocation !== -1) {\n        this.state.position.lat = MAP_MARKERS[this.state.commonLocation].latitude;\n        this.state.position.lng = MAP_MARKERS[this.state.commonLocation].longitude;\n      }\n\n      return postStepLocationUpdateAPICALL(this.state.eventID, this.state.stepID, this.state.position.lat, this.state.position.lng, this.state.commonLocation).then(function (isChanged) {\n        if (isChanged) {\n          alert(\"Step Created and Location Set Successfully\");\n\n          _this3.props.history.push('add-step');\n\n          _this3.forceUpdate();\n        } else {\n          alert(\"An error has happened while binding the location\");\n\n          _this3.forceUpdate();\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(Popup, {\n        ref: \"popup\",\n        className: \"popup\",\n        trigger: React.createElement(\"label\", {\n          ref: \"popupMapBtn\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        }),\n        position: \"right center\",\n        modal: true,\n        closeOnDocumentClick: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginBottom: 20,\n          marginTop: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        style: {\n          marginBottom: 20,\n          textAlign: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"Pick a location\"), React.createElement(Dropdown, {\n        options: MAP_MARKERS_NAMES,\n        onChange: function onChange(data) {\n          if (data.label !== \"Other\") _this4.setState({\n            commonLocation: MAP_MARKERS_NAMES.indexOf(data.label)\n          });else _this4.setState({\n            commonLocation: -1\n          });\n        },\n        value: MAP_MARKERS_NAMES[0],\n        placeholder: \"Select an option\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(LocationPicker, {\n        containerElement: React.createElement(\"div\", {\n          style: {\n            height: '50%'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166\n          },\n          __self: this\n        }),\n        mapElement: React.createElement(\"div\", {\n          style: {\n            height: '400px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          },\n          __self: this\n        }),\n        defaultPosition: defaultPosition,\n        onChange: this.handleLocationChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        className: \"btn btn-outline-success\",\n        style: {\n          width: '97%'\n        },\n        onClick: function onClick() {\n          _this4.updateLocationOfStep();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }, \"Bind Location to Step\"))), React.createElement(Form, {\n        schema: schema,\n        uiSchema: uiSchema,\n        onSubmit: this.onSubmitStepCreation,\n        onError: console.log(\"errors\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return AddStep;\n}(Component);\n\nexport default withRouter(AddStep);","map":{"version":3,"sources":["/Users/IDogueto/Desktop/Repositories/emdashboarddeployed/src/dashboard/Step/addStep.js"],"names":["React","Component","LocationPicker","postStepCreationAPICALL","postStepLocationUpdateAPICALL","GLOBAL","Form","withRouter","Popup","MAP_MARKERS_NAMES","MAP_MARKERS","Dropdown","defaultPosition","lat","lng","uiSchema","eventTitle","eventHashedID","schema","AddStep","props","onSubmitStepCreation","e","formData","stepTitle","stepDescription","then","IDs","console","log","eventID","stepID","setState","state","length","window","confirm","refs","popupMapBtn","click","alert","forceUpdate","position","commonLocation","HASHEDIDEVENTCREATED","properties","default","EVENTTITLE","handleLocationChange","bind","updateLocationOfStep","address","latitude","longitude","isChanged","history","push","marginBottom","marginTop","textAlign","data","label","indexOf","height","width"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport LocationPicker from 'react-location-picker';\nimport {postStepCreationAPICALL, postStepLocationUpdateAPICALL} from '../../utils/requests';\nimport GLOBAL from \"../../utils/global\";\nimport Form from \"react-jsonschema-form\";\nimport {withRouter} from 'react-router-dom';\nimport Popup from 'reactjs-popup';\nimport {MAP_MARKERS_NAMES} from \"../../utils/mapMarkers\";\nimport {MAP_MARKERS} from \"../../utils/mapMarkers\";\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\n\n/* Default position */\nconst defaultPosition = {\n  lat: 33.538379,\n  lng: -5.105569\n};\n\nconst uiSchema = {\n    eventTitle: {\n        \"ui:readonly\": true\n    },\n    eventHashedID: {\n        \"ui:readonly\": true\n    },\n};\n\n\nconst schema = {\n  \"title\": \"Add Step\",\n  \"description\": \"Create a new step\",\n  \"type\": \"object\",\n  \"required\": [\n    \"stepTitle\",\n    \"stepDescription\",\n  ],\n  \"properties\": {\n      \"eventHashedID\": {\n          \"type\": \"string\",\n          \"title\": \"Event ID\"\n      },\n      \"eventTitle\": {\n          \"type\": \"string\",\n          \"title\": \"Event Title\"\n      },\n    \"stepTitle\": {\n      \"type\": \"string\",\n      \"title\": \"Step Title\"\n    },\n    \"stepDescription\": {\n      \"type\": \"string\",\n      \"title\": \"Step Description\"\n    }\n  }\n};\n\nclass AddStep extends Component {\n  constructor (props) {\n    super(props);\n\n    this.state = {\n      position: {\n         lat: 0,\n         lng: 0\n      },\n        stepID: \"\",\n        eventID: \"\",\n        commonLocation: -1\n    };\n\n\n      if(GLOBAL.HASHEDIDEVENTCREATED !== \"\")\n          schema.properties.eventHashedID.default = GLOBAL.HASHEDIDEVENTCREATED;\n\n      if(GLOBAL.EVENTTITLE !== \"\")\n          schema.properties.eventTitle.default = GLOBAL.EVENTTITLE;\n\n    // Bind\n    this.handleLocationChange = this.handleLocationChange.bind(this);\n    this.updateLocationOfStep = this.updateLocationOfStep.bind(this);\n    this.onSubmitStepCreation = this.onSubmitStepCreation.bind(this);\n\n  }\n\n  handleLocationChange ({ position, address }) {\n    // Set new location\n      this.setState({\n          position: position\n      });\n  }\n    \n    updateLocationOfStep () {\n        if(this.state.commonLocation !== -1){\n            this.state.position.lat = MAP_MARKERS[this.state.commonLocation].latitude;\n            this.state.position.lng = MAP_MARKERS[this.state.commonLocation].longitude;\n        }\n        return postStepLocationUpdateAPICALL(this.state.eventID, this.state.stepID,this.state.position.lat, this.state.position.lng, this.state.commonLocation)\n        .then((isChanged) => {\n            if (isChanged) {\n                alert(\"Step Created and Location Set Successfully\");\n                this.props.history.push('add-step');\n                this.forceUpdate();\n            } else {\n                alert(\"An error has happened while binding the location\");\n                this.forceUpdate();\n            }\n        })\n        \n  }\n    \n    \n    \n\n    onSubmitStepCreation = function({formData}, e) {\n        return postStepCreationAPICALL(formData.eventHashedID, formData.stepTitle, formData.stepDescription)\n        .then(IDs => {\n            console.log(\"HEE:\" + IDs.eventID);\n            console.log(\"HAA:\" + IDs.stepID);\n            this.setState({\n                eventID: IDs.eventID\n            });\n            this.setState({\n                stepID: IDs.stepID\n            });\n            if(this.state.stepID.length === 24){\n                if (window.confirm('Would you like to bind this step to a location?')) {\n                    this.refs.popupMapBtn.click();\n                } else {\n                    alert(\"Step Created Successfully\");\n                    this.forceUpdate();\n                }\n            }\n        })\n\n    };\n\n  render () {\n    return (\n        \n      <div>\n        <Popup\n        ref={\"popup\"}\n        className='popup'\n        trigger={<label ref={\"popupMapBtn\"}></label>}\n        position=\"right center\"\n        modal\n        closeOnDocumentClick>\n            \n          <div style={{marginBottom: 20, marginTop: 20}}>\n        <h3 style={{marginBottom: 20, textAlign: 'center'}}>Pick a location</h3>\n        <Dropdown options={MAP_MARKERS_NAMES} onChange={(data) => {\n        if(data.label !== \"Other\")\n            this.setState({\n                commonLocation: MAP_MARKERS_NAMES.indexOf(data.label)\n            });\n        else\n            this.setState({\n                commonLocation: -1\n            });\n\n        \n    }} value={MAP_MARKERS_NAMES[0]} placeholder=\"Select an option\" />\n        </div>\n        <div>\n          <LocationPicker\n            containerElement={ <div style={ {height: '50%'} } /> }\n            mapElement={ <div style={ {height: '400px'} } /> }\n            defaultPosition={defaultPosition}\n            onChange={this.handleLocationChange} />\n          <button className='btn btn-outline-success' style={{\n            width: '97%'}} onClick={()=>{\n                    this.updateLocationOfStep();\n\n            }}>Bind Location to Step</button>  \n          </div>\n        </Popup>\n        \n        <Form schema={schema}\n              uiSchema={uiSchema}\n        onSubmit={this.onSubmitStepCreation}\n        onError={console.log(\"errors\")} />\n\n\n \n      </div>\n    )\n  }\n}\n\nexport default withRouter(AddStep);"]},"metadata":{},"sourceType":"module"}